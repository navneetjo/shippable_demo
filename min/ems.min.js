var mongoose=require("mongoose"),app=require("express")(),bodyParser=require("body-parser"),express=require("express");mongoose.connect("mongodb://localhost/test");var db=mongoose.connection;console.log("connected to database"),console.log("in viewAll file"),db.once("open",function(){var a=new mongoose.Schema({code:Number,name:String,city:String});app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!0})),app.use(express["static"](__dirname+"/public/html"));var b=mongoose.model("employee",a);app.get("/getData",function(a,c){b.find(function(a,b){return a?c.send(a):(console.log("message: "+b),c.json(b),void c.end())})}),app.get("/getData/:id",function(a,c){b.findOne({_id:a.params.id},function(a,b){return a?c.send(a):(console.log("message: "+b),c.json(b),void c.end())})}),app.post("/postData",function(a,c){var d=new b(a.body);d.code=a.body.code,d.name=a.body.name,d.city=a.body.city,d.save(function(a,b){a&&console.log("getting error"+a),console.log("getting data"+b),c.send({message:"Employee details added successfully"})})}),app.put("/update/:id",function(a,c){b.findOne({_id:a.params.id},function(b,d){console.log("complete data is ;- "+d),d.code=a.body.code,d.name=a.body.name,d.city=a.body.city,d.save(function(a){return a?c.send(a):(console.log("id"+d._id),console.log("Employee Code :- "+d.code),console.log("Name of Employee :- "+d.name),console.log("City :- "+d.city),void c.json({message:"Employee details updated!"}))})})}),app["delete"]("/delete/:id",function(a,c){b.remove({_id:a.params.id},function(a){return a?c.send(a):void c.send({message:"Successfully deleted"})})})}),app.set("port",process.env.PORT||3e3);var server=app.listen(app.get("port"),function(){console.log("Express server listening on port : "+server.address().port)});